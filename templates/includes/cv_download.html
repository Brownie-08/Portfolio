{% load portfolio_extras %}
{% comment %}
Universal CV Download Button Component
-------------------------------------
This template provides a reusable CV download button that can be included anywhere in the site.
It automatically checks if personal_info.resume exists and shows the appropriate button style.

Usage:
  {% include 'includes/cv_download.html' %}
  
Parameters (optional):
  - button_class: Custom CSS classes for the button
  - button_text: Custom text for the button
  - icon_class: Custom icon classes (default: "bi bi-download")
  - show_icon: Whether to show the icon (default: True unless context is navbar)
  - target: Link target attribute (default: "_blank")
  - button_context: Button context for styling ('navbar', 'footer', 'page', 'cta')

Examples:
  Basic usage:
    {% include 'includes/cv_download.html' %}
  
  Custom styling:
    {% include 'includes/cv_download.html' with button_class="btn btn-outline-primary" button_text="Get My Resume" %}
  
  Navbar usage:
    {% include 'includes/cv_download.html' with button_context="navbar" %}
  
  Footer usage:
    {% include 'includes/cv_download.html' with button_context="footer" %}
    
  CTA usage:
    {% include 'includes/cv_download.html' with button_context="cta" %}
{% endcomment %}

{% if personal_info.resume %}
    {% if button_context == "navbar" %}
        <li class="nav-item dropdown">
            <a class="{{ button_class|default:'nav-link dropdown-toggle' }}" href="#" id="cvDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                {% if show_icon and icon_class %}
                    <i class="{{ icon_class|default:'bi bi-file-earmark-pdf' }} me-1"></i>
                {% endif %}
                {{ button_text|default:"Resume" }}
            </a>
            <ul class="dropdown-menu" aria-labelledby="cvDropdown">
                <li><a class="dropdown-item" href="{% url 'portfolio:latest_resume_view' %}" target="_blank">
                    <i class="bi bi-eye me-2"></i>View Resume
                </a></li>
                <li><a class="dropdown-item" href="{% url 'portfolio:latest_resume_download' %}">
                    <i class="bi bi-download me-2"></i>Download Resume
                </a></li>
            </ul>
        </li>
    {% elif button_context == "footer" %}
        <a href="{% url 'portfolio:latest_resume_download' %}" class="{{ button_class|default:'btn btn-outline-light btn-sm' }}">
            {% if show_icon|default:True %}
                <i class="{{ icon_class|default:'bi bi-download' }} me-1"></i>
            {% endif %}
            {{ button_text|default:"Download CV" }}
        </a>
    {% elif button_context == "cta" %}
        <div class="btn-group" role="group">
            <a href="{% url 'portfolio:latest_resume_view' %}" class="{{ button_class|default:'btn btn-primary btn-lg' }}" target="_blank">
                {% if show_icon|default:True %}
                    <i class="bi bi-eye me-1"></i>
                {% endif %}
                View Resume
            </a>
            <a href="{% url 'portfolio:latest_resume_download' %}" class="{{ button_class|default:'btn btn-outline-primary btn-lg' }}">
                <i class="bi bi-download me-1"></i>
                Download
            </a>
        </div>
    {% else %}
        {% comment %}Default page context - Show both options{% endcomment %}
        <div class="d-flex gap-2 flex-wrap">
            <a href="{% url 'portfolio:latest_resume_view' %}" class="{{ button_class|default:'btn btn-outline-primary' }}" target="_blank">
                <i class="bi bi-eye me-1"></i>
                View Resume
            </a>
            <a href="{% url 'portfolio:latest_resume_download' %}" class="{{ button_class|default:'btn btn-primary' }}">
                <i class="bi bi-download me-1"></i>
                Download Resume
            </a>
        </div>
    {% endif %}
{% endif %}
